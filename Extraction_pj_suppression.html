<!DOCTYPE html>
<html lang="fr">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="macros vba utiles" />
    <link href="style.css" rel="stylesheet" />
    <title>Vba Excel</title>
  </head>
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-6FY47S0T7L"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-6FY47S0T7L');
</script>
  <body>
    <header>
      <img src="excel_vba.png" alt="macros vba" />
      <h1>Macro Outlook</h1>
    </header>
    <nav>
      <ul>
        <li><a href="index.html">Accueil</a></li>
        <li>
          ➧ Suppression de lignes
          <ul class="sous_menus">
            <a href="Suppression_Ligne_Vide.html"
              ><li>Suppression ligne vide</li></a
            >
            <a href="Suppression_Ligne_Date.html"
              ><li>Suppression ligne selon critère de date</li></a
            >
            <a href="Suppression_Doublons.html"
              ><li>Suppression de doublons</li></a
            >
          </ul>
        </li>
        <li>
          ➧ Boite de dialogue
          <ul class="sous_menus">
            <a href="MsgBox_InputBox.html"><li>MsgBox et InputBox</li></a>
          </ul>
        </li>
        <li>
          ➧ Chercher une valeur
          <ul class="sous_menus">
            <a href="Cherche_Valeur_Cellule.html"
              ><li>Chercher une valeur et renvoyer la cellule</li></a
            >
            <a href="Cherche_Valeur_Message.html"
              ><li>Chercher une valeur et renvoyer un message si trouvé</li></a
            >
          </ul>
        </li>
        <li>
          ➧ Copier des données
          <ul class="sous_menus">
            <a href="Copier_Fichier.html"><li>Copier un fichier choisi</li></a>
            <a href="Copier_Ligne_Critere.html"
              ><li>Copier une ligne selon un critère</li></a
            >
            <a href="Copier_Valeur.html"
              ><li>Copier les valeurs d'un fichier sans l'ouvrir</li></a
            >
            <a href="Copier_Ligne_Vide.html"
              ><li>Copier à partir de la première ligne vide</li></a
            >
            <a href="Compiler_Onglets.html"
              ><li>Compiler plusieus onglets</li></a
            >
            <a href="Copie_Fichier.html"
              ><li>Créer un copie d'un fichier</li></a
            >
            <a href="Copier_Fichier_Suppression.html"
              ><li>
                Créer une copie d'un fichier en supprimant le fichier d'origine
              </li></a
            >
            <a href="Division_Fichier.html"
              ><li>Créer plusieurs fichiers à partir d'un seul</li></a
            >
            <a href="Fichier_csv.html"
              ><li>Copier un fichier au format csv</li></a
            >
          </ul>
        </li>
        <a href="Deproteger.html"
          ><li>Déprotéger un fichier ou un classeur</li></a
        >
        <li>
          ➧ Les Boucles
          <ul class="sous_menus">
            <a href="Do_While.html"><li>Do While</li></a>
            <a href="Do_Until.html"><li>Do Until</li></a>
            <a href="While.html"><li>While</li></a>
            <a href="For_Next.html"><li>For Next</li></a>
            <a href="ForEachNext.html"><li>For Each...Next</li></a>
          </ul>
        </li>
        <li>
          <b>➧ Macro Outlook</b>
          <ul class="sous_menus">
            <a href="Envoi_Fichier.html"
              ><li>Envoyer un fichier par mail</li></a
            >
            <a href="Envoi_mailing.html"
              ><li>Mailing à partir d'une liste</li></a
            >
            <a href="Envoi_pj.html"
              ><li>Envoi mail avec plusieurs pièces jointes</li></a
            >
            <a href="Extraction_pj.html"><li>Extraction pièces jointes</li></a>
            <a href="Extraction_pj_suppression.html"
              ><li>Extraction pièces jointes avec suppression</li></a
            >
            <a href="Script_mail.html"
              ><li>Exécuter une macro à la réception d'un mail</li></a
            >
          </ul>
        </li>
        <li>
          ➧ Utilisation de dossier
          <ul class="sous_menus">
            <a href="Impression_Dossier.html"
              ><li>Impression des pièces d'un dossier</li></a
            >
            <a href="Suppression_Dossier.html"
              ><li>Suppression des pièces d'un dossier</li></a
            >
            <a href="Creation_Dossier.html"><li>Création d'un dossier</li></a>
            <a href="Liste_Dossier.html"
              ><li>Obtenir une liste des fichiers d'un dossier</li></a
            >
            <a href="Liste_Dossier_Repertoire.html"
              ><li>
                Obtenir une liste des fichiers d'un dossier et sous répertoires
              </li></a
            >
            <a href="Compiler_Dossier.html"
              ><li>Compiler tous les fichiers d'un dossier</li></a
            >
          </ul>
        </li>
        <li>
          ➧ Fonctions VBA
          <ul class="sous_menus">
            <a href="Defusionner_Cellules.html"
              ><li>Défusionner les cellules d'un fichier</li></a
            >
            <a href="Suppression_Filtres.html"
              ><li>Suppression des filtres d'un fichier</li></a
            >
            <a href="Ajuster_Largeur.html"
              ><li>Ajuster la largeur d'une colonne</li></a
            >
            <a href="Evaluate.html"><li>Application Evaluate</li></a>
            <li>
              ➧ Fonctions personnalisées
              <ul class="sous_menus2">
                <a href="Date_Enregistrement.html"
                  ><li>Récupérer la date d'enregistrement d'un fichier</li></a
                >
                <a href="Cherche_a.html"
                  ><li>Faire une recherche selon une liste de valeurs</li></a
                >
                <a href="Cherche_Caracteres_Enregistrement.html"
                  ><li>
                    Rechercher une chaine de caractères selon une base
                  </li></a
                >
                <a href="Couleur.html"
                  ><li>Trouver la couleur d'une cellule</li></a
                >
              </ul>
            </li>
          </ul>
        </li>
        <li>
          ➧ Utilisation de Userform
          <ul class="sous_menus">
            <a href="Champs_Visibles.html"
              ><li>Compter le nombre de champs visibles</li></a
            >
            <a href="Recuperer_Valeurs.html"
              ><li>Récupérer les valeurs de cellules dans un userform</li></a
            >
          </ul>
        </li>
      </ul>
    </nav>
    <h2>Extraction de pièces jointes</h2>
    <div>
      <p>
        Cette macro permet d'extraire les pièces jointes aux e-mails outlook
        reçus en supprimant les pièces jointes des mails :
        <br />
      </p>

      <pre>

        Sub SaveAttachment()

        'Declaration
        Dim myItems, myItem, myAttachments, myAttachment As Object
        Dim myOrt As String
        Dim myOlApp As New Outlook.Application
        Dim myOlExp As Outlook.Explorer
        Dim myOlSel As Outlook.Selection
        Dim i As Integer
        
        'Boîte de dialogue simple pour le chemin de sauvegarde
        myOrt = InputBox("Destination", "Save Attachments", "U:\REQUETE\EN COURS\TEST\")
    
        On Error Resume Next
        
        'Actions sur les objets sélectionnés
        Set myOlExp = myOlApp.ActiveExplorer
        Set myOlSel = myOlExp.Selection
        
        'boucle
        For Each myItem In myOlSel
            Set myAttachments = myItem.Attachments
            If myAttachments.Count > 0 Then
                'Ajoute une remarque dans le corps du message
                myItem.Body = myItem.Body & vbCrLf & _
                    "pièce jointe enlevée:" & vbCrLf
                    
                'for all attachments do...
                For i = 1 To myAttachments.Count
                
                    'save them to destination
                    myAttachments(i).SaveAsFile myOrt & _
                        myAttachments(i).DisplayName
                    myItem.Body = myItem.Body & _
                        "File: " & myOrt & _
                        myAttachments(i).DisplayName & vbCrLf
                        
                Next i
                
                'Enlève les pièces jointes du message
                While myAttachments.Count > 0
                
                    myAttachments(1).Delete
                    
                Wend
                
                'Sauvegarde le message sans ses pièces jointes
                myItem.Save
            End If
            
        Next
        
        Set myItems = Nothing
        Set myItem = Nothing
        Set myAttachments = Nothing
        Set myAttachment = Nothing
        Set myOlApp = Nothing
        Set myOlExp = Nothing
        Set myOlSel = Nothing
        
    End Sub
    
        
        </pre
      >
    </div>
    <footer>
      <div>&copy Samir BEN HADDOU 2021</div>
      <div><a href="Contact.html" alt="Contact" class="footer">Contact</a></div>
    </footer>
  </body>
</html>
