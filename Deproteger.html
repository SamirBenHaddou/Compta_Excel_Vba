<!DOCTYPE html>
<html lang="fr">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="macros vba utiles" />
    <link href="style.css" rel="stylesheet" />
    <title>Vba Excel</title>
  </head>

  <body>
    <header>
      <img src="excel_vba.png" alt="macros vba" />
      <h1>Deprotéger un fichier</h1>
    </header>
    <nav>
      <ul>
        <li><a href="index.html">Accueil</a></li>
        <li>
          ➧ Suppression de lignes
          <ul class="sous_menus">
            <a href="Suppression_Ligne_Vide.html"
              ><li>Suppression ligne vide</li></a
            >
            <a href="Suppression_Ligne_Date.html"
              ><li>Suppression ligne selon critère de date</li></a
            >
            <a href="Suppression_Doublons.html"
              ><li>Suppression de doublons</li></a
            >
          </ul>
        </li>
        <li>
          ➧ Boite de dialogue
          <ul class="sous_menus">
            <a href="MsgBox_InputBox.html"><li>MsgBox et InputBox</li></a>
          </ul>
        </li>
        <li>
          ➧ Chercher une valeur
          <ul class="sous_menus">
            <a href="Cherche_Valeur_Cellule.html"
              ><li>Chercher une valeur et renvoyer la cellule</li></a
            >
            <a href="Cherche_Valeur_Message.html"
              ><li>Chercher une valeur et renvoyer un message si trouvé</li></a
            >
          </ul>
        </li>
        <li>
          ➧ Copier des données
          <ul class="sous_menus">
            <a href="Copier_Fichier.html"><li>Copier un fichier choisi</li></a>
            <a href="Copier_Ligne_Critere.html"
              ><li>Copier une ligne selon un critère</li></a
            >
            <a href="Copier_Valeur.html"
              ><li>Copier les valeurs d'un fichier sans l'ouvrir</li></a
            >
            <a href="Copier_Ligne_Vide.html"
              ><li>Copier à partir de la première ligne vide</li></a
            >
            <a href="Compiler_Onglets.html"
              ><li>Compiler plusieus onglets</li></a
            >
            <a href="Copie_Fichier.html"
              ><li>Créer un copie d'un fichier</li></a
            >
            <a href="Copier_Fichier_Suppression.html"
              ><li>
                Créer une copie d'un fichier en supprimant le fichier d'origine
              </li></a
            >
            <a href="Division_Fichier.html"
              ><li>Créer plusieurs fichiers à partir d'un seul</li></a
            >
            <a href="Fichier_csv.html"
              ><li>Copier un fichier au format csv</li></a
            >
          </ul>
        </li>
        <a href="Deproteger.html"
          ><li><b>Déprotéger un fichier ou un classeur</b></li></a
        >
        <li>
          ➧ Les Boucles
          <ul class="sous_menus">
            <a href="Do_While.html"><li>Do While</li></a>
            <a href="Do_Until.html"><li>Do Until</li></a>
            <a href="While.html"><li>While</li></a>
            <a href="For_Next.html"><li>For Next</li></a>
            <a href="ForEachNext.html"><li>For Each...Next</li></a>
          </ul>
        </li>
        <li>
          ➧ Macro Outlook
          <ul class="sous_menus">
            <a href="Envoi_Fichier.html"
              ><li>Envoyer un fichier par mail</li></a
            >
            <a href="Envoi_mailing.html"
              ><li>Mailing à partir d'une liste</li></a
            >
            <a href="Envoi_pj.html"
              ><li>Envoi mail avec plusieurs pièces jointes</li></a
            >
            <a href="Extraction_pj.html"><li>Extraction pièces jointes</li></a>
            <a href="Extraction_pj_suppression.html"
              ><li>Extraction pièces jointes avec suppression</li></a
            >
            <a href="Script_mail.html"
              ><li>Exécuter une macro à la réception d'un mail</li></a
            >
          </ul>
        </li>
        <li>
          ➧ Utilisation de dossier
          <ul class="sous_menus">
            <a href="Impression_Dossier.html"
              ><li>Impression des pièces d'un dossier</li></a
            >
            <a href="Suppression_Dossier.html"
              ><li>Suppression des pièces d'un dossier</li></a
            >
            <a href="Creation_Dossier.html"><li>Création d'un dossier</li></a>
            <a href="Liste_Dossier.html"
              ><li>Obtenir une liste des fichiers d'un dossier</li></a
            >
            <a href="Liste_Dossier_Repertoire.html"
              ><li>
                Obtenir une liste des fichiers d'un dossier et sous répertoires
              </li></a
            >
            <a href="Compiler_Dossier.html"
              ><li>Compiler tous les fichiers d'un dossier</li></a
            >
          </ul>
        </li>
        <li>
          ➧ Fonctions VBA
          <ul class="sous_menus">
            <a href="Defusionner_Cellules.html"
              ><li>Défusionner les cellules d'un fichier</li></a
            >
            <a href="Suppression_Filtres.html"
              ><li>Suppression des filtres d'un fichier</li></a
            >
            <a href="Ajuster_Largeur.html"
              ><li>Ajuster la largeur d'une colonne</li></a
            >
            <a href="Evaluate.html"><li>Application Evaluate</li></a>
            <li>
              ➧ Fonctions personnalisées
              <ul class="sous_menus2">
                <a href="Date_Enregistrement.html"
                  ><li>Récupérer la date d'enregistrement d'un fichier</li></a
                >
                <a href="Cherche_a.html"
                  ><li>Faire une recherche selon une liste de valeurs</li></a
                >
                <a href="Cherche_Caracteres_Enregistrement.html"
                  ><li>
                    Rechercher une chaine de caractères selon une base
                  </li></a
                >
                <a href="Couleur.html"
                  ><li>Trouver la couleur d'une cellule</li></a
                >
              </ul>
            </li>
          </ul>
        </li>
        <li>
          ➧ Utilisation de Userform
          <ul class="sous_menus">
            <a href="Champs_Visibles.html"
              ><li>Compter le nombre de champs visibles</li></a
            >
            <a href="Recuperer_Valeurs.html"
              ><li>Récupérer les valeurs de cellules dans un userform</li></a
            >
          </ul>
        </li>
      </ul>
    </nav>
    <h2>Deprotéger un fichier</h2>
    <div>
      <p>
        Cette macro permet de déprotéger un fichier excel (protection avec mot
        de passe) :
      </p>
      <br />
      <pre>

        Sub Deproteger()
        Dim A As Byte, B As Byte, C As Byte, D As Byte, E As Byte
        Dim F As Byte, G As Byte, H As Byte, I As Byte, J As Byte
        Dim K As Byte, L As Byte, M As Byte, N As Byte, O As Byte
        Dim Reponse As Byte, Temps As Variant
        Dim Cible As Object, Passe As String
        ' Demande ce qu'il faut déprotéger.
        Reponse = MsgBox("Voulez-vous déprotéger le classeur actif ?" &amp; vbCrLf &amp _
        "Si vous répondez non, c'est la feuille active qui sera déprotégée. ", _
        vbYesNoCancel, "Déprotectionnateur")
        On Error Resume Next
        ' Teste ce qu'il faut déprotéger.
        Select Case Reponse
        Case vbYes
        ' Définit le classeur actif comme cible à déprotéger.
        Set Cible = ActiveWorkbook
        ' Teste si le classeur est protégé.
        If Not (Cible.ProtectStructure Or Cible.ProtectWindows) Then
        MsgBox "Le classeur actif n'est pas protégé. " &amp vbCrLf &amp _
        vbCrLf &amp "Andouille !", vbOKOnly, "Déprotectionnateur"
        Exit Sub
        End If
        ' Teste si le classeur est protégé sans mot de passe.
        Err.Clear
        Cible.Unprotect vbNullString
        If Err = 0 Then
        MsgBox "La protection du classeur actif a été supprimée. " _
        &amp vbCrLf &amp "Il n'y avait pas de mot de passe. Petit rigolo !", _
        vbOKOnly, "Déprotectionnateur"
        Exit Sub
        End If
        Case vbNo
        ' Définit la feuille active comme cible à déprotéger.
        Set Cible = ActiveSheet
        ' Teste si la feuille est protégée (on ne teste pas UserInterfaceOnly qui ne peut être positionné que par macro 
        ' et n'est pas enregistré avec le classeur).
        If Not (Cible.ProtectContents Or Cible.ProtectDrawingObjects Or _
        Cible.ProtectScenarios) Then
        MsgBox "La feuille active n'est pas protégée. " &amp vbCrLf &amp _
        vbCrLf &amp "Patate !", vbOKOnly, "Déprotectionnateur"
        Exit Sub
        End If
        ' Teste si la feuille est protégée sans mot de passe.
        Err.Clear
        Cible.Unprotect vbNullString
        If Err = 0 Then
        MsgBox "La protection de la feuille active a été supprimée. " _
        &amp vbCrLf &amp "Il n'y avait pas de mot de passe. Quelle burne !", _
        vbOKOnly, "Déprotectionnateur"
        Exit Sub
        End If
        Case Else
        ' Annulation demandée par l'utilisateur.
        MsgBox String(14, " ") &amp "Ciao !", vbOKOnly, "Déprotectionnateur"
        Exit Sub
        End Select
        ' Note l'instant de départ.
        Temps = Timer
        ' Boucles de calcul des mots de passe. On utilise ici les codes ascii des caractères "0" et "1".
        For A = 48 To 49
        For B = 48 To 49
        For C = 48 To 49
        For D = 48 To 49
        For E = 48 To 49
        For F = 48 To 49
        For G = 48 To 49
        For H = 48 To 49
        For I = 48 To 49
        For J = 48 To 49
        For K = 48 To 49
        For L = 48 To 49
        For M = 48 To 49
        For N = 48 To 49
        For O = 48 To 49
        ' Calcule le mot de passe.
        Passe = Chr(A) &amp Chr(B) &amp Chr(C) &amp Chr(D) &amp Chr(E) &amp _
        Chr(F) &amp Chr(G) &amp Chr(H) &amp Chr(I) &amp Chr(J) &amp _
        Chr(K) &amp Chr(L) &amp Chr(M) &amp Chr(N) &amp Chr(O)
        ' Essaie de déprotéger la cible.
        Err.Clear
        Cible.Unprotect Passe
        ' Teste si la cible est bien déprotégé.
        If Err = 0 Then
        ' Si oui, affiche le mot de passe et sort.
        MsgBox "La protection a été supprimée en " &amp _
        Timer - Temps &amp " secondes. " &amp vbCrLf &amp _
        "Le mot de passe équivalent trouvé est :" &amp _
        vbCrLf &amp vbCrLf &amp String(28, " ") &amp Passe, _
        vbOKOnly, "Déprotectionnateur"
        Exit Sub
        End If
        Next
        Next
        Next
        Next
        Next
        Next
        Next
        Next
        Next
        Next
        Next
        Next
        Next
        Next
        Next
        ' Message impossible à atteindre.
        MsgBox "Mot de passe introuvable." &amp vbCrLf &amp vbCrLf &amp _
        "C'est pas normal !!!", vbOKOnly, "Déprotectionnateur"
        End Sub
        
                 
        </pre
      >
    </div>
    <footer>
      <div>&copy Samir BEN HADDOU 2021</div>
      <div><a href="Contact.html" alt="Contact" class="footer">Contact</a></div>
    </footer>
  </body>
</html>
