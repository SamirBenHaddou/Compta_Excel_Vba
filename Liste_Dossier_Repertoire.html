<!DOCTYPE html>
<html lang="fr">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="macros vba utiles" />
    <link href="style.css" rel="stylesheet" />
    <title>Vba Excel</title>
  </head>

  <body>
    <header>
      <img src="excel_vba.png" alt="macros vba" />
      <h1>Utilisation d'un dossier</h1>
    </header>
    <nav>
      <ul>
        <li><a href="index.html">Accueil</a></li>
        <li>
          ➧ Suppression de lignes
          <ul class="sous_menus">
            <a href="Suppression_Ligne_Vide.html"
              ><li>Suppression ligne vide</li></a
            >
            <a href="Suppression_Ligne_Date.html"
              ><li>Suppression ligne selon critère de date</li></a
            >
            <a href="Suppression_Doublons.html"
              ><li>Suppression de doublons</li></a
            >
          </ul>
        </li>
        <li>
          ➧ Boite de dialogue
          <ul class="sous_menus">
            <a href="MsgBox_InputBox.html"><li>MsgBox et InputBox</li></a>
          </ul>
        </li>
        <li>
          ➧ Chercher une valeur
          <ul class="sous_menus">
            <a href="Cherche_Valeur_Cellule.html"
              ><li>Chercher une valeur et renvoyer la cellule</li></a
            >
            <a href="Cherche_Valeur_Message.html"
              ><li>Chercher une valeur et renvoyer un message si trouvé</li></a
            >
          </ul>
        </li>
        <li>
          ➧ Copier des données
          <ul class="sous_menus">
            <a href="Copier_Fichier.html"><li>Copier un fichier choisi</li></a>
            <a href="Copier_Ligne_Critere.html"
              ><li>Copier une ligne selon un critère</li></a
            >
            <a href="Copier_Valeur.html"
              ><li>Copier les valeurs d'un fichier sans l'ouvrir</li></a
            >
            <a href="Copier_Ligne_Vide.html"
              ><li>Copier à partir de la première ligne vide</li></a
            >
            <a href="Compiler_Onglets.html"
              ><li>Compiler plusieus onglets</li></a
            >
            <a href="Copie_Fichier.html"
              ><li>Créer un copie d'un fichier</li></a
            >
            <a href="Copier_Fichier_Suppression.html"
              ><li>
                Créer une copie d'un fichier en supprimant le fichier d'origine
              </li></a
            >
            <a href="Division_Fichier.html"
              ><li>Créer plusieurs fichiers à partir d'un seul</li></a
            >
            <a href="Fichier_csv.html"
              ><li>Copier un fichier au format csv</li></a
            >
          </ul>
        </li>
        <a href="Deproteger.html"
          ><li>Déprotéger un fichier ou un classeur</li></a
        >
        <li>
          ➧ Les Boucles
          <ul class="sous_menus">
            <a href="Do_While.html"><li>Do While</li></a>
            <a href="Do_Until.html"><li>Do Until</li></a>
            <a href="While.html"><li>While</li></a>
            <a href="For_Next.html"><li>For Next</li></a>
            <a href="ForEachNext.html"><li>For Each...Next</li></a>
          </ul>
        </li>
        <li>
          ➧ Macro Outlook
          <ul class="sous_menus">
            <a href="Envoi_Fichier.html"
              ><li>Envoyer un fichier par mail</li></a
            >
            <a href="Envoi_mailing.html"
              ><li>Mailing à partir d'une liste</li></a
            >
            <a href="Envoi_pj.html"
              ><li>Envoi mail avec plusieurs pièces jointes</li></a
            >
            <a href="Extraction_pj.html"><li>Extraction pièces jointes</li></a>
            <a href="Extraction_pj_suppression.html"
              ><li>Extraction pièces jointes avec suppression</li></a
            >
            <a href="Script_mail.html"
              ><li>Exécuter une macro à la réception d'un mail</li></a
            >
          </ul>
        </li>
        <li>
          <b>➧ Utilisation de dossier</b>
          <ul class="sous_menus">
            <a href="Impression_Dossier.html"
              ><li>Impression des pièces d'un dossier</li></a
            >
            <a href="Suppression_Dossier.html"
              ><li>Suppression des pièces d'un dossier</li></a
            >
            <a href="Creation_Dossier.html"><li>Création d'un dossier</li></a>
            <a href="Liste_Dossier.html"
              ><li>Obtenir une liste des fichiers d'un dossier</li></a
            >
            <a href="Liste_Dossier_Repertoire.html"
              ><li>
                Obtenir une liste des fichiers d'un dossier et sous répertoires
              </li></a
            >
            <a href="Compiler_Dossier.html"
              ><li>Compiler tous les fichiers d'un dossier</li></a
            >
          </ul>
        </li>
        <li>
          ➧ Fonctions VBA
          <ul class="sous_menus">
            <a href="Defusionner_Cellules.html"
              ><li>Défusionner les cellules d'un fichier</li></a
            >
            <a href="Suppression_Filtres.html"
              ><li>Suppression des filtres d'un fichier</li></a
            >
            <a href="Ajuster_Largeur.html"
              ><li>Ajuster la largeur d'une colonne</li></a
            >
            <a href="Evaluate.html"><li>Application Evaluate</li></a>
            <li>
              ➧ Fonctions personnalisées
              <ul class="sous_menus2">
                <a href="Date_Enregistrement.html"
                  ><li>Récupérer la date d'enregistrement d'un fichier</li></a
                >
                <a href="Cherche_a.html"
                  ><li>Faire une recherche selon une liste de valeurs</li></a
                >
                <a href="Cherche_Caracteres_Enregistrement.html"
                  ><li>
                    Rechercher une chaine de caractères selon une base
                  </li></a
                >
                <a href="Couleur.html"
                  ><li>Trouver la couleur d'une cellule</li></a
                >
              </ul>
            </li>
          </ul>
        </li>
        <li>
          ➧ Utilisation de Userform
          <ul class="sous_menus">
            <a href="Champs_Visibles.html"
              ><li>Compter le nombre de champs visibles</li></a
            >
            <a href="Recuperer_Valeurs.html"
              ><li>Récupérer les valeurs de cellules dans un userform</li></a
            >
          </ul>
        </li>
      </ul>
    </nav>
    <h2>Liste des fichiers d'un dossier et des sous-dossiers</h2>
    <div>
      <p>
        Cette macro permet d'obenir la liste des documents contenus dans un
        dossier ainsi que dans les sous-dossiers du répertoire :
        <br />
      </p>

      <pre>

        Option Explicit
        Sub TestListeFichiers()
           Dim Dossier As String
            'Définit le répertoire pour débuter la recherche de fichiers.
           '(Attention à ne pas indiquer un répertoire qu contient trop de sous-dossiers ou de
           'fichiers, sinon le temps de traitement va être très long).
           Dossier = "E:\Compta"
           'Appelle la procédure de recherche des fichiers
           ListeFichiers Dossier
            'Ajuste la largeur des colonnes A:E en fonction du contenu des cellules.
           Columns("A:E").AutoFit
           MsgBox "Terminé"
       End Sub
        Sub ListeFichiers(Repertoire As String)
           '
           'Nécessite d'activer la référence "Microsoft Scripting RunTime"
            Dim Fso As Scripting.FileSystemObject
           Dim SourceFolder As Scripting.Folder
           Dim SubFolder As Scripting.Folder
           Dim FileItem As Scripting.File
           Dim i As Long
            Set Fso = CreateObject("Scripting.FileSystemObject")
           Set SourceFolder = Fso.GetFolder(Repertoire)
        
           'Récupère le numéro de la dernière ligne vide dans la colonne A.
           i = Range("A65536").End(xlUp).Row + 1
            'Boucle sur tous les fichiers du répertoire
           For Each FileItem In SourceFolder.Files
               'Inscrit le nom du fichier dans la cellule
               Cells(i, 1) = FileItem.Name
               'Ajoute un lien hypertexte vers le fichier
               ActiveSheet.Hyperlinks.Add Anchor:=Cells(i, 1), _
                   Address:=FileItem.ParentFolder & "\" & FileItem.Name
               'Indique la date de création
               Cells(i, 2) = FileItem.DateCreated
               'Indique la date de dernier acces
               Cells(i, 3) = FileItem.DateLastAccessed
               'Indique la date de dernière modification
               Cells(i, 4) = FileItem.DateLastModified
               'Nom du répertoire
               Cells(i, 5) = FileItem.ParentFolder
                i = i + 1
           Next FileItem
            '--- Appel récursif pour lister les fichier dans les sous-répertoires ---.
           For Each SubFolder In SourceFolder.subfolders
               ListeFichiers SubFolder.Path
           Next SubFolder
        
       End Sub
       
        
        </pre
      >
    </div>
    <footer>
      <div>&copy Samir BEN HADDOU 2021</div>
      <div><a href="Contact.html" alt="Contact" class="footer">Contact</a></div>
    </footer>
  </body>
</html>
